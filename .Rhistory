knitr::opts_chunk$set(echo = TRUE)
datos <- read_excel("C:/HECTOR/CIENCIA DE DATOS/TERCERO/EDIG/TRABAJO/datos_trabajo.xlsx")
library("readxl")
library("plm")
library("forecast")
library("dplyr")
library("tidyr")
datos <- read_excel("C:/HECTOR/CIENCIA DE DATOS/TERCERO/EDIG/TRABAJO/datos_trabajo.xlsx")
datos <- read_excel("./datos_trabajo.xlsx")
data <- pdata.frame(datos, index = c("CCAA","Periodo"), drop.index = FALSE, row.names = TRUE)
head(data)
data$Personas_activas = as.numeric(data$Personas_activas)
data$Precio_vivienda = as.numeric(data$Precio_vivienda)
colnames(data)[colnames(data) == "Coste.salarial.total"] <- "Coste_salarial_total"
head(data)
pool_datos <- plm(Precio_vivienda ~ Personas_activas + IPC + Coste_salarial_total, data = data, model = "pooling")
summary(pool_datos)
efectos_fijos <- plm(Precio_vivienda ~ Personas_activas + IPC + Coste_salarial_total + as.factor(CCAA), data = data, model="pooling")
summary(efectos_fijos)
efectos_aleatorios <- plm(Precio_vivienda ~ Personas_activas + IPC + Coste_salarial_total , data = data, model = "random")
summary(efectos_aleatorios)
pFtest(efectos_fijos, pool_datos)
pFtest(efectos_fijos, pool_datos)
phtest(efectos_fijos, efectos_aleatorios)
df <- read_excel("./precio_vivienda_trabajo.xlsx")
# Ordenar las filas por la columna de fechas (B)
df <- df[order(as.character(df$Periodo)), ]
dept.ts<-ts(df$Precio_vivienda, start=c(1,1), end=c(17,3), freq = 4)
autoplot(dept.ts)
dept.ts.train<-window(dept.ts,start=c(1,1),end=c(16,4))
dept.ts.valid<-window(dept.ts,start=c(17,1),end=c(17,3))
dept.lm<-tslm(dept.ts.train~trend+season,lambda=0)
summary(dept.lm)
df
autoplot(df)
lineplot(df)
library(ggplot2)
p = ggplot(df, aes(x = Periodo, y = Precio_vivienda)) + geom_path()
library(ggplot2)
p = ggplot(df, aes(x = Periodo, y = Precio_vivienda)) + geom_path()
p
library(ggplot2)
p = ggplot(df, aes(y = Precio_vivienda)) + geom_path()
p
library(ggplot2)
p = ggplot(df, aes(x= 1, y = Precio_vivienda)) + geom_path()
p
library(ggplot2)
p = ggplot(df, aes(x= range(1, length(df$Periodo)), y = Precio_vivienda)) + geom_path()
p
library(ggplot2)
p = ggplot(df, aes(x= range(1, length(Periodo)), y = Precio_vivienda)) + geom_path()
p
library(ggplot2)
p = ggplot(df, aes(x= c(range(1, length(Periodo))), y = Precio_vivienda)) + geom_path()
p
df
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
df$Periodo <- as.Date(gsub("T", "", df$Periodo), format = "%Y%m")
df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2012-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2012-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.1, vjust = 1.5, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal()
df
df <- read_excel("./precio_vivienda_trabajo.xlsx")
# Ordenar las filas por la columna de fechas (B)
df <- df[order(as.character(df$Periodo)), ]
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
df$Periodo <- as.Date(gsub("T", "", df$Periodo), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2012-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2012-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.1, vjust = 1.5, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal()
df
df <- read_excel("./precio_vivienda_trabajo.xlsx")
df
# Ordenar las filas por la columna de fechas (B)
df <- df[order(as.character(df$Periodo)), ]
df
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(gsub("T", "", df$Periodo), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2012-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2012-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.1, vjust = 1.5, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal()
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
df
# Función para convertir el trimestre a fecha
convertir_a_fecha <- function(trimestre) {
año <- substr(trimestre, 1, 4)
t <- substr(trimestre, 6, 6)
# Definir el mes de inicio para cada trimestre
mes_inicio <- ifelse(t == "1", "01",
ifelse(t == "2", "04",
ifelse(t == "3", "07", "10")))
as.Date(paste(año, mes_inicio, "01", sep = "-"))
}
# Aplicar la función a la columna Periodo
df$Periodo <- sapply(df$Periodo, convertir_a_fecha)
df <- read_excel("./precio_vivienda_trabajo.xlsx")
# Ordenar las filas por la columna de fechas (B)
df <- df[order(as.character(df$Periodo)), ]
# Función para convertir el trimestre a fecha
convertir_a_fecha <- function(trimestre) {
año <- substr(trimestre, 1, 4)
t <- substr(trimestre, 6, 6)
# Definir el mes de inicio para cada trimestre
mes_inicio <- ifelse(t == "1", "01",
ifelse(t == "2", "04",
ifelse(t == "3", "07", "10")))
as.Date(paste(año, mes_inicio, "01", sep = "-"))
}
# Aplicar la función a la columna Periodo
df$Periodo <- sapply(df$Periodo, convertir_a_fecha)
df
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2012-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2012-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.1, vjust = 1.5, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal()
df <- read_excel("./precio_vivienda_trabajo.xlsx")
# Ordenar las filas por la columna de fechas (B)
df <- df[order(as.character(df$Periodo)), ]
# Función para convertir el trimestre a fecha
convertir_a_fecha <- function(trimestre) {
año <- substr(trimestre, 1, 4)
t <- substr(trimestre, 6, 6)
# Definir el mes de inicio para cada trimestre
mes_inicio <- ifelse(t == "1", "01",
ifelse(t == "2", "04",
ifelse(t == "3", "07", "10")))
return(as.Date(paste(año, mes_inicio, "01", sep = "-")))
}
# Aplicar la función a la columna Periodo
df$Periodo <- sapply(df$Periodo, convertir_a_fecha)
df
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2008-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2008-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.1, vjust = 1.5, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal()
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2008-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2008-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.1, vjust = 1.5, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") # Formato del eje X
df <- read_excel("./precio_vivienda_trabajo.xlsx")
# Ordenar las filas por la columna de fechas (B)
df <- df[order(as.character(df$Periodo)), ]
# Función para convertir el trimestre a fecha
convertir_a_fecha <- function(trimestre) {
año <- substr(trimestre, 1, 4)
t <- substr(trimestre, 6, 6)
# Definir el mes de inicio para cada trimestre
mes_inicio <- ifelse(t == "1", "01",
ifelse(t == "2", "04",
ifelse(t == "3", "07", "10")))
return(as.Date(paste(año, mes_inicio, "01", sep = "-")))
}
# Aplicar la función a la columna Periodo
df$Periodo <- sapply(df$Periodo, convertir_a_fecha)
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2008-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2008-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.1, vjust = 1.5, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") # Formato del eje X
class(df$Periodo)
df <- read_excel("./precio_vivienda_trabajo.xlsx")
# Ordenar las filas por la columna de fechas (B)
df <- df[order(as.character(df$Periodo)), ]
# Función para convertir el trimestre a fecha
convertir_a_fecha <- function(trimestre) {
año <- substr(trimestre, 1, 4)
t <- substr(trimestre, 6, 6)
# Definir el mes de inicio para cada trimestre
mes_inicio <- ifelse(t == "1", "01",
ifelse(t == "2", "04",
ifelse(t == "3", "07", "10")))
fecha = as.Date(paste(año, mes_inicio, "01", sep = "-"))
return(format(fecha, "%Y-%m-%d"))
}
# Aplicar la función a la columna Periodo
df$Periodo <- sapply(df$Periodo, convertir_a_fecha)
class(df$Periodo)
df
df$Periodo = as.Date(df$Periodo)
df
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2008-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2008-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.1, vjust = 1.5, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") # Formato del eje X
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2008-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2008-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.2, vjust = 1.5, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") # Formato del eje X
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2008-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2008-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.2, vjust = 1, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") # Formato del eje X
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2008-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2008-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.2, vjust = 1, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
geom_vline(xintercept = as.Date("2014-01-01"), linetype = "dashed", color = "blue") +  # Línea vertical en 2012
annotate("text", x = as.Date("2014-01-01"), y = max(df$Precio_vivienda), label = "Empieza a remontar el precio", hjust = -0.2, vjust = 1, color = "blue") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") # Formato del eje X
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2008-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2008-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.2, vjust = 1, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
geom_vline(xintercept = as.Date("2014-01-01"), linetype = "dashed", color = "blue") +  # Línea vertical en 2012
annotate("text", x = as.Date("2014-01-01"), y = max(df$Precio_vivienda), label = "Empieza a remontar el precio", hjust = -0.1, vjust = 1.5, color = "blue") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") # Formato del eje X
library(ggplot2)
# Convertir la columna 'Periodo' a formato de fecha (aproximando cada trimestre al inicio del mes correspondiente)
# df$Periodo <- as.Date(substr(df$Periodo, 1,4), format = "%Y%m")
# df$Periodo <- as.Date(sub("-01", "-04", sub("-02", "-07", sub("-03", "-10", format(df$Periodo, "%Y-%m")))))
# Crear el gráfico
ggplot(df, aes(x = Periodo, y = Precio_vivienda)) +
geom_line() +  # Línea para mostrar la evolución del precio
geom_vline(xintercept = as.Date("2008-01-01"), linetype = "dashed", color = "red") +  # Línea vertical en 2012
annotate("text", x = as.Date("2008-01-01"), y = max(df$Precio_vivienda), label = "Estallido burbuja", hjust = -0.2, vjust = 1, color = "red") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
geom_vline(xintercept = as.Date("2014-01-01"), linetype = "dashed", color = "blue") +  # Línea vertical en 2012
annotate("text", x = as.Date("2014-01-01"), y = max(df$Precio_vivienda), label = "Empieza a remontar el precio", hjust = -0.1, vjust = 1, color = "blue") +
labs(title = "Evolución del Precio de la Vivienda en España (2007-2023)",
x = "Periodo",
y = "Precio de la Vivienda") +
theme_minimal() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") # Formato del eje X
